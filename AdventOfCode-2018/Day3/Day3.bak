#lang racket

(struct pt [x y] #:transparent)

(define test1
  (list "1 @ 1,3: 4x4"
        "2 @ 3,1: 4x4"
        "3 @ 5,5: 2x2"))

(define rx #rx"@ (.+),(.+): (.+)x(.+)")

(define (string->locs str)
  (match-let ([(list m X Y DX DY) (regexp-match rx str)])
    (for*/list ([dx (string->number DX)]
                [dy (string->number DY)])
      (pt (+ 1 (string->number X) dx)
          (+ 1 (string->number Y) dy)))))

(define total
  (flatten (map string->locs test1)))

(- (length total)
   (set-count (list->set total)))

(define input
  (read-line (open-input-file "input.txt")))